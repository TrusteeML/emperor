!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(b.dashjs||(b.dashjs={})).Protection=a()}}(function(){return function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(b,c,d){"use strict";var e={};e.encode=function(a){for(var b=[],c=0;c<a.length;++c){var d=a.charCodeAt(c);d<128?b.push(d):d<2048?(b.push(192|d>>6),b.push(128|63&d)):d<65536?(b.push(224|d>>12),b.push(128|63&d>>6),b.push(128|63&d)):(b.push(240|d>>18),b.push(128|63&d>>12),b.push(128|63&d>>6),b.push(128|63&d))}return b},e.decode=function(a){for(var b=[],c=0;c<a.length;){var d=a[c++];d<128||(d<224?(d=(31&d)<<6,d|=63&a[c++]):d<240?(d=(15&d)<<12,d|=(63&a[c++])<<6,d|=63&a[c++]):(d=(7&d)<<18,d|=(63&a[c++])<<12,d|=(63&a[c++])<<6,d|=63&a[c++])),b.push(String.fromCharCode(d))}return b.join("")};var f={};!function(b){var c=function(a){for(var c=0,d=[],e=0|a.length/3;0<e--;){var f=(a[c]<<16)+(a[c+1]<<8)+a[c+2];c+=3,d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push(b.charAt(63&f))}if(2==a.length-c){var f=(a[c]<<16)+(a[c+1]<<8);d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push("=")}else if(1==a.length-c){var f=a[c]<<16;d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push("==")}return d.join("")},d=function(){for(var a=[],c=0;c<b.length;++c)a[b.charCodeAt(c)]=c;return a["=".charCodeAt(0)]=0,a}(),g=function(a){for(var b=0,c=[],e=0|a.length/4;0<e--;){var f=(d[a.charCodeAt(b)]<<18)+(d[a.charCodeAt(b+1)]<<12)+(d[a.charCodeAt(b+2)]<<6)+d[a.charCodeAt(b+3)];c.push(255&f>>16),c.push(255&f>>8),c.push(255&f),b+=4}return c&&("="==a.charAt(b-2)?(c.pop(),c.pop()):"="==a.charAt(b-1)&&c.pop()),c},h={};h.encode=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b},h.decode=function(b){for(var c=0;c<s.length;++c)a[c]=String.fromCharCode(a[c]);return a.join("")},f.decodeArray=function(a){var b=g(a);return new Uint8Array(b)},f.encodeASCII=function(a){var b=h.encode(a);return c(b)},f.decodeASCII=function(a){var b=g(a);return h.decode(b)},f.encode=function(a){var b=e.encode(a);return c(b)},f.decode=function(a){var b=g(a);return e.decode(b)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0!==d&&(d.decode=f.decode,d.decodeArray=f.decodeArray)},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a,b,c){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g;if(!a)throw new Error("event type cannot be null or undefined");if(!b||"function"!=typeof b)throw new Error("listener must be a function: "+b);if(!(d(a,b,c)>=0)){f[a]=f[a]||[];var h={callback:b,scope:c,priority:e};f[a].some(function(b,c){if(e>b.priority)return f[a].splice(c,0,h),!0})||f[a].push(h)}}function b(a,b,c){if(a&&b&&f[a]){var e=d(a,b,c);e<0||f[a].splice(e,1)}}function c(a,b){if(a&&f[a]){if(b=b||{},b.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");b.type=a,f[a].forEach(function(a){return a.callback.call(a.scope,b)})}}function d(a,b,c){var d=-1;return f[a]?(f[a].some(function(a,e){if(a.callback===b&&(!c||c===a.scope))return d=e,!0}),d):d}function e(){f={}}var f={};return{on:a,off:b,trigger:c,reset:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(3)),g=0,h=5e3;e.__dashjs_factory_name="EventBus";var i=f.default.getSingletonFactory(e);i.EVENT_PRIORITY_LOW=g,i.EVENT_PRIORITY_HIGH=h;var j=i;c.default=j},{3:3}],3:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(){function a(a,b,c,d){var e=g(d);!e[a]&&b&&(e[a]={instance:b,override:c})}function b(a,b){for(var c in j){var d=j[c];if(d.context===a&&d.name===b)return d.instance}return null}function c(a,b,c){for(var d in j){var e=j[d];if(e.context===a&&e.name===b)return void(j[d].instance=c)}j.push({name:b,context:a,instance:c})}function d(a){return function(b){return void 0===b&&(b={}),{create:function(){return f(a.__dashjs_factory_name,a.apply({context:b},arguments),b,arguments)}}}}function e(a){return function(c){var d;return void 0===c&&(c={}),{getInstance:function(){return d||(d=b(c,a.__dashjs_factory_name)),d||(d=f(a.__dashjs_factory_name,a.apply({context:c},arguments),c,arguments),j.push({name:a.__dashjs_factory_name,context:c,instance:d})),d}}}}function f(a,b,c,d){var e=g(c),f=e[a];if(f){var i=f.instance;if(!f.override)return i.apply({context:c,factory:h},d);i=i.apply({context:c,factory:h,parent:b},d);for(var j in i)b.hasOwnProperty(j)&&(b[j]=i[j])}return b}function g(a){var b;return i.forEach(function(c){c===a&&(b=c)}),b||(b=i.push(a)),b}var h,i=[],j=[];return h={extend:a,getSingletonInstance:b,setSingletonInstance:c,getSingletonFactory:e,getClassFactory:d}}(),e=d;c.default=e},{}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){return!b||"object"!==e(b)&&"function"!=typeof b?h(a):b}function h(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&k(a,b)}function k(a,b){return(k=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var l=d(a(6)),m=function(a){function b(){var a;return f(this,b),a=g(this,i(b).call(this)),a.AST_IN_FUTURE="astinfuture",a.BUFFERING_COMPLETED="bufferingCompleted",a.BUFFER_CLEARED="bufferCleared",a.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",a.BYTES_APPENDED="bytesAppended",a.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",a.CHUNK_APPENDED="chunkAppended",a.CURRENT_TRACK_CHANGED="currenttrackchanged",a.DATA_UPDATE_COMPLETED="dataUpdateCompleted",a.DATA_UPDATE_STARTED="dataUpdateStarted",a.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",a.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",a.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",a.INITIALIZATION_LOADED="initializationLoaded",a.INIT_FRAGMENT_LOADED="initFragmentLoaded",a.INIT_REQUESTED="initRequested",a.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",a.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",a.LOADING_COMPLETED="loadingCompleted",a.LOADING_PROGRESS="loadingProgress",a.MANIFEST_UPDATED="manifestUpdated",a.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",a.QUOTA_EXCEEDED="quotaExceeded",a.REPRESENTATION_UPDATED="representationUpdated",a.SEGMENTS_LOADED="segmentsLoaded",a.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",a.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",a.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",a.STREAMS_COMPOSED="streamsComposed",a.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",a.STREAM_COMPLETED="streamCompleted",a.STREAM_INITIALIZED="streaminitialized",a.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",a.TIMED_TEXT_REQUESTED="timedTextRequested",a.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",a.URL_RESOLUTION_FAILED="urlResolutionFailed",a.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",a.XLINK_ALL_ELEMENTS_LOADED="xlinkAllElementsLoaded",a.XLINK_ELEMENT_LOADED="xlinkElementLoaded",a.XLINK_READY="xlinkReady",a}return j(b,a),b}(l.default),n=m;c.default=n},{6:6}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){return!b||"object"!==e(b)&&"function"!=typeof b?h(a):b}function h(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&k(a,b)}function k(a,b){return(k=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var l=d(a(4)),m=function(a){function b(){return f(this,b),g(this,i(b).apply(this,arguments))}return j(b,a),b}(l.default),n=new m,o=n;c.default=o},{4:4}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=function(){function a(){d(this,a)}return f(a,[{key:"extend",value:function(a,b){if(a){var c=!!b&&b.override,d=!!b&&b.publicOnly;for(var e in a)!a.hasOwnProperty(e)||this[e]&&!c||d&&-1===a[e].indexOf("public_")||(this[e]=a[e])}}}]),a}(),h=g;c.default=h},{}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var h=d(a(1)),i=function(){function a(){e(this,a)}return g(a,null,[{key:"findCencContentProtection",value:function(a){for(var b=null,c=0;c<a.length;++c){var d=a[c];"urn:mpeg:dash:mp4protection:2011"===d.schemeIdUri.toLowerCase()&&"cenc"===d.value.toLowerCase()&&(b=d)}return b}},{key:"getPSSHData",value:function(a){var b=8,c=new DataView(a),d=c.getUint8(b);return b+=20,d>0&&(b+=4+16*c.getUint32(b)),b+=4,a.slice(b)}},{key:"getPSSHForKeySystem",value:function(b,c){var d=a.parsePSSHList(c);return d.hasOwnProperty(b.uuid.toLowerCase())?d[b.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(a){return"pssh"in a?h.default.decodeArray(a.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(a){if(null===a)return[];for(var b=new DataView(a),c=!1,d={},e=0;!c;){var f,g,h,i,j=e;if(e>=b.buffer.byteLength)break;if(f=b.getUint32(e),g=e+f,e+=4,1886614376===b.getUint32(e))if(e+=4,0===(h=b.getUint8(e))||1===h){e++,e+=3,i="";var k,l;for(k=0;k<4;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=4,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<2;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;for(e+=2,i+="-",k=0;k<6;k++)l=b.getUint8(e+k).toString(16),i+=1===l.length?"0"+l:l;e+=6,i=i.toLowerCase(),b.getUint32(e),e+=4,d[i]=b.buffer.slice(j,g),e=g}else e=g;else e=g}return d}}]),a}(),j=i;c.default=j},{1:1}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){var c=null,e=(0,g.default)(d).getInstance();e.setConfig({log:a.log}),e.initialize();var h=b(a);return!c&&h&&(c=(0,f.default)(d).create({protectionModel:h,protectionKeyController:e,adapter:a.adapter,eventBus:a.eventBus,log:a.log}),a.capabilities.setEncryptedMediaSupported(!0)),c}function b(a){var b=a.log,e=a.eventBus,f=a.videoModel.getElement();return void 0!==f.onencrypted&&void 0!==f.mediaKeys&&void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(b("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,i.default)(d).create({log:b,eventBus:e})):c(f,n)?(b("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,j.default)(d).create({log:b,eventBus:e,api:c(f,n)})):c(f,m)?(b("EME detected on this user agent! (ProtectionModel_01b)"),(0,k.default)(d).create({log:b,eventBus:e,api:c(f,m)})):(b("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function c(a,b){for(var c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d[Object.keys(d)[0]]])return d}return null}var d=this.context;return{createProtectionSystem:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(10)),g=d(a(11)),h=d(a(9)),i=d(a(16)),j=d(a(17)),k=d(a(15)),l=d(a(3)),m=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],n=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];e.__dashjs_factory_name="Protection";var o=l.default.getClassFactory(e);o.events=h.default;var p=o;c.default=p},{10:10,11:11,15:15,16:16,17:17,3:3,9:9}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){return!b||"object"!==e(b)&&"function"!=typeof b?h(a):b}function h(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&k(a,b)}function k(a,b){return(k=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var l=d(a(6)),m=function(a){function b(){var a;return f(this,b),a=g(this,i(b).call(this)),a.INTERNAL_KEY_MESSAGE="internalKeyMessage",a.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",a.KEY_ADDED="public_keyAdded",a.KEY_ERROR="public_keyError",a.KEY_MESSAGE="public_keyMessage",a.KEY_SESSION_CLOSED="public_keySessionClosed",a.KEY_SESSION_CREATED="public_keySessionCreated",a.KEY_SESSION_REMOVED="public_keySessionRemoved",a.KEY_STATUSES_CHANGED="public_keyStatusesChanged",a.KEY_SYSTEM_ACCESS_COMPLETE="keySystemAccessComplete",a.KEY_SYSTEM_SELECTED="public_keySystemSelected",a.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",a.NEED_KEY="needkey",a.PROTECTION_CREATED="public_protectioncreated",a.PROTECTION_DESTROYED="public_protectiondestroyed",a.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",a.TEARDOWN_COMPLETE="protectionTeardownComplete",a.VIDEO_ELEMENT_SELECTED="videoElementSelected",a}return j(b,a),b}(l.default),n=new m,o=n;c.default=o},{6:6}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a){function b(){z=I.getKeySystems(),A=[],E=!1,F="temporary",G="",h.default.extend(l.default.events)}function c(a,b,c){if(!E){var d;b||c||(d=K.getStreamsInfo(a)[0]),B=b||(d?K.getMediaInfoForType(a,d,"audio"):null),C=c||(d?K.getMediaInfoForType(a,d,"video"):null);var e=C||B,f=I.getSupportedKeySystemsFromContentProtection(e.contentProtection);f&&f.length>0&&u(f,!0),E=!0}}function d(a){var b=g.default.getPSSHForKeySystem(H,a);if(b){for(var c=J.getAllInitData(),d=0;d<c.length;d++)if(I.initDataEquals(b,c[d]))return void M("DRM: Ignoring initData because we have already seen it!");try{J.createKeySession(b,F)}catch(e){L.trigger(h.default.KEY_SESSION_CREATED,{data:null,error:"Error creating key session! "+e.message})}}else L.trigger(h.default.KEY_SESSION_CREATED,{data:null,error:"Selected key system is "+H.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!"})}function f(a){J.loadKeySession(a)}function k(a){J.removeKeySession(a)}function m(a){J.closeKeySession(a)}function n(a){J.setServerCertificate(a)}function o(a){a?(J.setMediaElement(a),L.on(h.default.NEED_KEY,x,this),L.on(h.default.INTERNAL_KEY_MESSAGE,w,this)):null===a&&(J.setMediaElement(a),L.off(h.default.NEED_KEY,x,this),L.off(h.default.INTERNAL_KEY_MESSAGE,w,this))}function p(a){F=a}function q(a){G=a}function r(a){D=a}function s(){o(null),H=void 0,J&&(J.reset(),J=null)}function t(a){var b=null,c=a.systemString;return D&&(b=c in D?D[c]:null),b}function u(a,b){var c=this,e=[],f=[];C&&f.push(new i.default(C.codec,G)),B&&e.push(new i.default(B.codec,G));var g,k=new j.default(e,f,"optional","temporary"===F?"optional":"required",[F]),l=[];if(H){for(g=0;g<a.length;g++)if(H===a[g].ks){var m=function(){l.push({ks:a[g].ks,configs:[k]});var e=function e(f){L.off(h.default.KEY_SYSTEM_ACCESS_COMPLETE,e,c),f.error?b||L.trigger(h.default.KEY_SYSTEM_SELECTED,{error:"DRM: KeySystem Access Denied! -- "+f.error}):(M("DRM: KeySystem Access Granted"),L.trigger(h.default.KEY_SYSTEM_SELECTED,{data:f.data}),d(a[g].initData))};return L.on(h.default.KEY_SYSTEM_ACCESS_COMPLETE,e,c),J.requestKeySystemAccess(l),"break"}();if("break"===m)break}}else if(void 0===H){H=null,A.push(a);for(var n=0;n<a.length;n++)l.push({ks:a[n].ks,configs:[k]});var o,p=function a(d){L.off(h.default.KEY_SYSTEM_ACCESS_COMPLETE,a,c),d.error?(H=void 0,L.off(h.default.INTERNAL_KEY_SYSTEM_SELECTED,q,c),b||L.trigger(h.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: KeySystem Access Denied! -- "+d.error})):(o=d.data,M("DRM: KeySystem Access Granted ("+o.keySystem.systemString+")!  Selecting key system..."),J.selectKeySystem(o))},q=function a(e){if(L.off(h.default.INTERNAL_KEY_SYSTEM_SELECTED,a,c),L.off(h.default.KEY_SYSTEM_ACCESS_COMPLETE,p,c),e.error)H=void 0,b||L.trigger(h.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: Error selecting key system! -- "+e.error});else{H=J.getKeySystem(),L.trigger(h.default.KEY_SYSTEM_SELECTED,{data:o});for(var f=0;f<A.length;f++)for(g=0;g<A[f].length;g++)if(H===A[f][g].ks){d(A[f][g].initData);break}}};L.on(h.default.INTERNAL_KEY_SYSTEM_SELECTED,q,c),L.on(h.default.KEY_SYSTEM_ACCESS_COMPLETE,p,c),J.requestKeySystemAccess(l)}else A.push(a)}function v(a,b){L.trigger(h.default.LICENSE_REQUEST_COMPLETE,{data:a,error:b})}function w(a){if(M("DRM: onKeyMessage"),a.error)return void M(a.error);var b=a.data;L.trigger(h.default.KEY_MESSAGE,{data:b});var c=b.messageType?b.messageType:"license-request",d=b.message,f=b.sessionToken,i=t(H),j=H.systemString,k=I.getLicenseServer(H,i,c),l={sessionToken:f,messageType:c};if(!k)return M("DRM: License server request not required for this message (type = "+a.data.messageType+").  Session ID = "+f.getSessionID()),void v(l);if(I.isClearKey(H)){var m=I.processClearKeyLicenseRequest(i,d);if(m)return M("DRM: ClearKey license request handled by application!"),v(l),void J.updateKeySession(f,m)}var n=new XMLHttpRequest,o=null;if(i)if(i.serverURL){var p=i.serverURL;"string"==typeof p&&""!==p?o=p:"object"===e(p)&&p.hasOwnProperty(c)&&(o=p[c])}else i.laURL&&""!==i.laURL&&(o=i.laURL);else(o=H.getLicenseServerURLFromInitData(g.default.getPSSHData(f.initData)))||(o=a.data.laURL);if(!(o=k.getServerURLFromMessage(o,d,c)))return void v(l,"DRM: No license server URL specified!");n.open(k.getHTTPMethod(c),o,!0),n.responseType=k.getResponseType(j,c),n.onload=function(){200==this.status?(v(l),J.updateKeySession(f,k.getLicenseMessage(this.response,j,c))):v(l,"DRM: "+j+' update, XHR status is "'+this.statusText+'" ('+this.status+"), expected to be 200. readyState is "+this.readyState+".  Response is "+(this.response?k.getErrorResponse(this.response,j,c):"NONE"))},n.onabort=function(){v(l,"DRM: "+j+' update, XHR aborted. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)},n.onerror=function(){v(l,"DRM: "+j+' update, XHR error. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)};var q=function(a){var b;if(a)for(b in a)"authorization"===b.toLowerCase()&&(n.withCredentials=!0),n.setRequestHeader(b,a[b])};i&&q(i.httpRequestHeaders),q(H.getRequestHeadersFromMessage(d)),i&&i.withCredentials&&(n.withCredentials=!0),n.send(H.getLicenseRequestFromMessage(d))}function x(a){if(M("DRM: onNeedKey"),"cenc"!==a.key.initDataType)return void M("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+a.key.initDataType);var b=a.key.initData;ArrayBuffer.isView(b)&&(b=b.buffer),M("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(b)));var c=I.getSupportedKeySystems(b,D);if(0===c.length)return void M("DRM: Received needkey event with initData, but we don't support any of the key systems!");u(c,!1)}var y,z,A,B,C,D,E,F,G,H,I=a.protectionKeyController,J=a.protectionModel,K=a.adapter,L=a.eventBus,M=a.log;return y={initialize:c,createKeySession:d,loadKeySession:f,removeKeySession:k,closeKeySession:m,setServerCertificate:n,setMediaElement:o,setSessionType:p,setRobustnessLevel:q,setProtectionData:r,reset:s},b(),y}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=d(a(7)),h=d(a(5)),i=d(a(28)),j=d(a(27)),k=d(a(3)),l=d(a(8));f.__dashjs_factory_name="ProtectionController";var m=k.default.getClassFactory(f);c.default=m},{27:27,28:28,3:3,5:5,7:7,8:8}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){a&&a.log&&(s=a.log)}function b(){t=[];var a;a=(0,i.default)(v).getInstance(),t.push(a),a=(0,h.default)(v).getInstance(),t.push(a),a=(0,g.default)(v).getInstance(),t.push(a),u=a}function c(){return t}function d(a){for(var b=0;b<t.length;b++)if(t[b].systemString===a)return t[b];return null}function e(a){return a===u}function n(a,b){if(a.byteLength===b.byteLength){for(var c=new Uint8Array(a),d=new Uint8Array(b),e=0;e<c.length;e++)if(c[e]!==d[e])return!1;return!0}return!1}function o(a){var b,c,d,e,f=[];if(a)for(d=0;d<t.length;++d)for(c=t[d],e=0;e<a.length;++e)if(b=a[e],b.schemeIdUri.toLowerCase()===c.schemeIdURI){var g=c.getInitData(b);g&&f.push({ks:t[d],initData:g})}return f}function p(a,b){var c,d=[],e=f.default.parsePSSHList(a);for(c=0;c<t.length;++c){var g=t[c].systemString,h=!b||g in b;t[c].uuid in e&&h&&d.push({ks:t[c],initData:e[t[c].uuid]})}return d}function q(a,b,c){if("license-release"===c||"individualization-request"===c)return null;var d=null;return b&&b.hasOwnProperty("drmtoday")?d=(0,j.default)(v).getInstance():"com.widevine.alpha"===a.systemString?d=(0,l.default)(v).getInstance():"com.microsoft.playready"===a.systemString?d=(0,k.default)(v).getInstance():"org.w3.clearkey"===a.systemString&&(d=(0,m.default)(v).getInstance()),d}function r(a,b){try{return u.getClearKeysFromProtectionData(a,b)}catch(c){return s("Failed to retrieve clearkeys from ProtectionData"),null}}var s,t,u,v=this.context;return{initialize:b,isClearKey:e,initDataEquals:n,getKeySystems:c,getKeySystemBySystemString:d,getSupportedKeySystemsFromContentProtection:o,getSupportedKeySystems:p,getLicenseServer:q,processClearKeyLicenseRequest:r,setConfig:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(7)),g=d(a(12)),h=d(a(14)),i=d(a(13)),j=d(a(19)),k=d(a(20)),l=d(a(21)),m=d(a(18)),n=d(a(3));e.__dashjs_factory_name="ProtectionKeyController";var o=n.default.getSingletonFactory(e);c.default=o},{12:12,13:13,14:14,18:18,19:19,20:20,21:21,3:3,7:7}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a,b){var c=null;if(a){for(var d=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b))),e=[],h=0;h<d.kids.length;h++){var i=d.kids[h],j=a.clearkeys.hasOwnProperty(i)?a.clearkeys[i]:null;if(!j)throw new Error("DRM: ClearKey keyID ("+i+") is not known!");e.push(new f.default(i,j))}c=new g.default(e)}return c}function b(a){return h.default.parseInitDataFromContentProtection(a)}function c(){return null}function d(a){return new Uint8Array(a)}function e(){return null}return{uuid:j,schemeIdURI:l,systemString:k,getInitData:b,getRequestHeadersFromMessage:c,getLicenseRequestFromMessage:d,getLicenseServerURLFromInitData:e,getClearKeysFromProtectionData:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(25)),g=d(a(22)),h=d(a(7)),i=d(a(3)),j="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",k="org.w3.clearkey",l="urn:uuid:"+j;e.__dashjs_factory_name="KeySystemClearKey";var m=i.default.getSingletonFactory(e);c.default=m},{22:22,25:25,3:3,7:7}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){var b,c,d={},e=new DOMParser,f="utf16"===h?new Uint16Array(a):new Uint8Array(a);b=String.fromCharCode.apply(null,f),c=e.parseFromString(b,"application/xml");for(var g=c.getElementsByTagName("name"),i=c.getElementsByTagName("value"),j=0;j<g.length;j++)d[g[j].childNodes[0].nodeValue]=i[j].childNodes[0].nodeValue;return d.hasOwnProperty("Content")&&(d["Content-Type"]=d.Content,delete d.Content),d}function b(a){var b,c,d=null,e=new DOMParser,f="utf16"===h?new Uint16Array(a):new Uint8Array(a);if(b=String.fromCharCode.apply(null,f),c=e.parseFromString(b,"application/xml"),c.getElementsByTagName("Challenge")[0]){var g=c.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;g&&(d=i.default.decode(g))}return d}function c(a){if(a)for(var b=new DataView(a),c=b.getUint16(4,!0),d=6,e=new DOMParser,f=0;f<c;f++){var g=b.getUint16(d,!0);d+=2;var h=b.getUint16(d,!0);if(d+=2,1===g){var i=a.slice(d,d+h),j=String.fromCharCode.apply(null,new Uint16Array(i)),k=e.parseFromString(j,"application/xml");if(k.getElementsByTagName("LA_URL")[0]){var l=k.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(l)return l}if(k.getElementsByTagName("LUI_URL")[0]){var m=k.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(m)return m}}else d+=h}return null}function d(a){var b,c,d,e,g,h=new Uint8Array([112,115,115,104,0,0,0,0]),j=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),k=0,l=null;if("pssh"in a)return f.default.parseInitDataFromContentProtection(a);if("pro"in a)l=i.default.decodeArray(a.pro.__text);else{if(!("prheader"in a))return null;l=i.default.decodeArray(a.prheader.__text)}return b=l.length,c=4+h.length+j.length+4+b,d=new ArrayBuffer(c),e=new Uint8Array(d),g=new DataView(d),g.setUint32(k,c),k+=4,e.set(h,k),k+=h.length,e.set(j,k),k+=j.length,g.setUint32(k,b),k+=4,e.set(l,k),k+=b,e.buffer}function e(a){if("utf8"!==a&&"utf16"!==a)throw new g.default("Illegal PlayReady message format! -- "+a);h=a}var h="utf16";return{uuid:j,schemeIdURI:l,systemString:k,getInitData:d,getRequestHeadersFromMessage:a,getLicenseRequestFromMessage:b,getLicenseServerURLFromInitData:c,setPlayReadyMessageFormat:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(7)),g=d(a(31)),h=d(a(3)),i=d(a(1)),j="9a04f079-9840-4286-ab92-e65be0885f95",k="com.microsoft.playready",l="urn:uuid:"+j;e.__dashjs_factory_name="KeySystemPlayReady";var m=h.default.getSingletonFactory(e);c.default=m},{1:1,3:3,31:31,7:7}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return f.default.parseInitDataFromContentProtection(a)}function b(){return null}function c(a){return new Uint8Array(a)}function d(){return null}return{uuid:h,schemeIdURI:j,systemString:i,getInitData:a,getRequestHeadersFromMessage:b,getLicenseRequestFromMessage:c,getLicenseServerURLFromInitData:d}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(7)),g=d(a(3)),h="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",i="com.widevine.alpha",j="urn:uuid:"+h;e.__dashjs_factory_name="KeySystemWidevine";var k=g.default.getSingletonFactory(e);c.default=k},{3:3,7:7}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){A=null,B=null,E=[],F=[],C=(0,f.default)(I).getInstance(),D=(0,m.default)(I).getInstance(),H=w()}function c(){A&&y();for(var a=0;a<F.length;a++)s(F[a]);J.trigger(l.default.TEARDOWN_COMPLETE)}function d(){return B}function e(){for(var a=[],b=0;b<E.length;b++)a.push(E[b].initData);for(var c=0;c<F.length;c++)a.push(F[c].initData);return a}function n(a){var b=A;b||(b=document.createElement("video"));for(var c=!1,d=0;d<a.length;d++)for(var e=a[d].ks.systemString,f=a[d].configs,g=null,h=null,i=0;i<f.length;i++){var m=f[i].videoCapabilities;if(m&&0!==m.length){h=[];for(var n=0;n<m.length;n++)""!==b.canPlayType(m[n].contentType,e)&&h.push(m[n])}if(!(!g&&!h||g&&0===g.length||h&&0===h.length)){c=!0;var o=new j.default(g,h),p=C.getKeySystemBySystemString(e);J.trigger(l.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new k.default(p,o)});break}}c||J.trigger(l.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function o(a){B=a.keySystem,J.trigger(l.default.INTERNAL_KEY_SYSTEM_SELECTED)}function p(a){A!==a&&(A&&y(),(A=a)&&(A.addEventListener(L.keyerror,H),A.addEventListener(L.needkey,H),A.addEventListener(L.keymessage,H),A.addEventListener(L.keyadded,H),J.trigger(l.default.VIDEO_ELEMENT_SELECTED)))}function q(a){if(!B)throw new Error("Can not create sessions until you have selected a key system");if(G||0===F.length){var b={sessionID:null,initData:a,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return E.push(b),A[L.generateKeyRequest](B.systemString,new Uint8Array(a)),b}throw new Error("Multiple sessions not allowed!")}function r(a,b){var c=a.sessionID;if(C.isClearKey(B))for(var d=0;d<b.keyPairs.length;d++)A[L.addKey](B.systemString,b.keyPairs[d].key,b.keyPairs[d].keyID,c);else A[L.addKey](B.systemString,new Uint8Array(b),a.initData,c)}function s(a){A[L.cancelKeyRequest](B.systemString,a.sessionID)}function t(){}function u(){}function v(){}function w(){return{handleEvent:function(a){var b=null;switch(a.type){case L.needkey:var c=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData
;J.trigger(l.default.NEED_KEY,{key:new g.default(c,"cenc")});break;case L.keyerror:if(b=x(F,a.sessionId),b||(b=x(E,a.sessionId)),b){var d="";switch(a.errorCode.code){case 1:d+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:d+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:d+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:d+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:d+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:d+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}d+="  System Code = "+a.systemCode,J.trigger(l.default.KEY_ERROR,{data:new h.default(b,d)})}else K("No session token found for key error");break;case L.keyadded:b=x(F,a.sessionId),b||(b=x(E,a.sessionId)),b?(K("DRM: Key added."),J.trigger(l.default.KEY_ADDED,{data:b})):K("No session token found for key added");break;case L.keymessage:if(G=null!==a.sessionId&&void 0!==a.sessionId,G?!(b=x(F,a.sessionId))&&E.length>0&&(b=E.shift(),F.push(b),b.sessionID=a.sessionId):E.length>0&&(b=E.shift(),F.push(b),0!==E.length&&D.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),b){var e=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;b.keyMessage=e,J.trigger(l.default.INTERNAL_KEY_MESSAGE,{data:new i.default(b,e,a.defaultURL)})}else K("No session token found for key message")}}}}function x(a,b){if(b&&a){for(var c=a.length,d=0;d<c;d++)if(a[d].sessionID==b)return a[d];return null}return null}function y(){A.removeEventListener(L.keyerror,H),A.removeEventListener(L.needkey,H),A.removeEventListener(L.keymessage,H),A.removeEventListener(L.keyadded,H)}var z,A,B,C,D,E,F,G,H,I=this.context,J=a.eventBus,K=a.log,L=a.api;return z={getAllInitData:e,requestKeySystemAccess:n,getKeySystem:d,selectKeySystem:o,setMediaElement:p,createKeySession:q,updateKeySession:r,closeKeySession:s,setServerCertificate:t,loadKeySession:u,removeKeySession:v,reset:c},b(),z}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(11)),g=d(a(29)),h=d(a(23)),i=d(a(24)),j=d(a(27)),k=d(a(26)),l=d(a(5)),m=d(a(30)),n=d(a(3));e.__dashjs_factory_name="ProtectionModel_01b";var o=n.default.getClassFactory(e);c.default=o},{11:11,23:23,24:24,26:26,27:27,29:29,3:3,30:30,5:5}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){A=null,B=null,C=null,D=[],F=(0,f.default)(G).getInstance(),E=w()}function c(){var a,b=D.length;if(0!==b)for(var c=function(a){x(a),0===D.length&&(B?(B.removeEventListener("encrypted",E),B.setMediaKeys(null).then(function(){H.trigger(k.default.TEARDOWN_COMPLETE)})):H.trigger(k.default.TEARDOWN_COMPLETE))},d=0;d<b;d++)a=D[d],function(b){a.session.closed.then(function(){c(b)}),v(a).catch(function(){c(b)})}(a);else H.trigger(k.default.TEARDOWN_COMPLETE)}function d(){return A}function e(){for(var a=[],b=0;b<D.length;b++)a.push(D[b].initData);return a}function l(a){u(a,0)}function m(a){a.mksa.createMediaKeys().then(function(b){A=a.keySystem,C=b,B&&B.setMediaKeys(C),H.trigger(k.default.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){H.trigger(k.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+a.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function n(a){B!==a&&(B&&(B.removeEventListener("encrypted",E),B.setMediaKeys(null)),(B=a)&&(B.addEventListener("encrypted",E),C&&B.setMediaKeys(C)))}function o(a){if(!A||!C)throw new Error("Can not set server certificate until you have selected a key system");C.setServerCertificate(a).then(function(){I("DRM: License server certificate successfully updated."),H.trigger(k.default.SERVER_CERTIFICATE_UPDATED)}).catch(function(a){H.trigger(k.default.SERVER_CERTIFICATE_UPDATED,{error:"Error updating server certificate -- "+a.name})})}function p(a,b){if(!A||!C)throw new Error("Can not create sessions until you have selected a key system");var c=C.createSession(b),d=y(c,a,b);c.generateRequest("cenc",a).then(function(){I("DRM: Session created.  SessionID = "+d.getSessionID()),H.trigger(k.default.KEY_SESSION_CREATED,{data:d})}).catch(function(a){x(d),H.trigger(k.default.KEY_SESSION_CREATED,{data:null,error:"Error generating key request -- "+a.name})})}function q(a,b){var c=a.session;F.isClearKey(A)&&(b=b.toJWK()),c.update(b).catch(function(b){H.trigger(k.default.KEY_ERROR,{data:new h.default(a,"Error sending update() message! "+b.name)})})}function r(a){if(!A||!C)throw new Error("Can not load sessions until you have selected a key system");var b=C.createSession();b.load(a).then(function(c){if(c){var d=y(b);I("DRM: Session created.  SessionID = "+d.getSessionID()),H.trigger(k.default.KEY_SESSION_CREATED,{data:d})}else H.trigger(k.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session! Invalid Session ID ("+a+")"})}).catch(function(b){H.trigger(k.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session ("+a+")! "+b.name})})}function s(a){a.session.remove().then(function(){I("DRM: Session removed.  SessionID = "+a.getSessionID()),H.trigger(k.default.KEY_SESSION_REMOVED,{data:a.getSessionID()})},function(b){H.trigger(k.default.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+a.getSessionID()+"). "+b.name})})}function t(a){v(a).catch(function(b){x(a),H.trigger(k.default.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+a.getSessionID()+") "+b.name})})}function u(a,b){!function(b){var c=a[b].ks,d=a[b].configs;navigator.requestMediaKeySystemAccess(c.systemString,d).then(function(a){var b="function"==typeof a.getConfiguration?a.getConfiguration():null,d=new j.default(c,b);d.mksa=a,H.trigger(k.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:d})}).catch(function(){++b<a.length?u(a,b):H.trigger(k.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied!"})})}(b)}function v(a){var b=a.session;return b.removeEventListener("keystatuseschange",a),b.removeEventListener("message",a),b.close()}function w(){return{handleEvent:function(a){switch(a.type){case"encrypted":if(a.initData){var b=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData;H.trigger(k.default.NEED_KEY,{key:new g.default(b,a.initDataType)})}}}}}function x(a){for(var b=0;b<D.length;b++)if(D[b]===a){D.splice(b,1);break}}function y(a,b,c){var d={session:a,initData:b,handleEvent:function(a){switch(a.type){case"keystatuseschange":H.trigger(k.default.KEY_STATUSES_CHANGED,{data:this});break;case"message":var b=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;H.trigger(k.default.INTERNAL_KEY_MESSAGE,{data:new i.default(this,b,void 0,a.messageType)})}},getSessionID:function(){return a.sessionId},getExpirationTime:function(){return a.expiration},getKeyStatuses:function(){return a.keyStatuses},getSessionType:function(){return c}};return a.addEventListener("keystatuseschange",d),a.addEventListener("message",d),a.closed.then(function(){x(d),I("DRM: Session closed.  SessionID = "+d.getSessionID()),H.trigger(k.default.KEY_SESSION_CLOSED,{data:d.getSessionID()})}),D.push(d),d}var z,A,B,C,D,E,F,G=this.context,H=a.eventBus,I=a.log;return z={getAllInitData:e,requestKeySystemAccess:l,getKeySystem:d,selectKeySystem:m,setMediaElement:n,setServerCertificate:o,createKeySession:p,updateKeySession:q,loadKeySession:r,removeKeySession:s,closeKeySession:t,reset:c},b(),z}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(11)),g=d(a(29)),h=d(a(23)),i=d(a(24)),j=d(a(26)),k=d(a(5)),l=d(a(3));e.__dashjs_factory_name="ProtectionModel_21Jan2015";var m=l.default.getClassFactory(e);c.default=m},{11:11,23:23,24:24,26:26,29:29,3:3,5:5}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){z=null,A=null,B=null,C=null,D=[],F=(0,f.default)(G).getInstance(),E=v()}function c(){try{for(var a=0;a<D.length;a++)r(D[a]);z&&z.removeEventListener(J.needkey,E),H.trigger(l.default.TEARDOWN_COMPLETE)}catch(b){H.trigger(l.default.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+b.message})}}function d(){return A}function e(){for(var a=[],b=0;b<D.length;b++)a.push(D[b].initData);return a}function m(a){for(var b=!1,c=0;c<a.length;c++)for(var d=a[c].ks.systemString,e=a[c].configs,f=null,g=null,h=0;h<e.length;h++){var i=e[h].audioCapabilities,m=e[h].videoCapabilities;if(i&&0!==i.length){f=[];for(var n=0;n<i.length;n++)window[J.MediaKeys].isTypeSupported(d,i[n].contentType)&&f.push(i[n])}if(m&&0!==m.length){g=[];for(var o=0;o<m.length;o++)window[J.MediaKeys].isTypeSupported(d,m[o].contentType)&&g.push(m[o])}if(!(!f&&!g||f&&0===f.length||g&&0===g.length)){b=!0;var p=new j.default(f,g),q=F.getKeySystemBySystemString(d);H.trigger(l.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new k.default(q,p)});break}}b||H.trigger(l.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function n(a){try{B=a.mediaKeys=new window[J.MediaKeys](a.keySystem.systemString),A=a.keySystem,C=a,z&&w(),H.trigger(l.default.INTERNAL_KEY_SYSTEM_SELECTED)}catch(b){H.trigger(l.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+A.systemString+")! Could not create MediaKeys -- TODO"})}}function o(a){z!==a&&(z&&z.removeEventListener(J.needkey,E),(z=a)&&(z.addEventListener(J.needkey,E),B&&w()))}function p(a){if(!A||!B||!C)throw new Error("Can not create sessions until you have selected a key system");var b=null;if(null!==C.ksConfiguration.videoCapabilities&&C.ksConfiguration.videoCapabilities.length>0&&(b=C.ksConfiguration.videoCapabilities[0]),null===b&&null!==C.ksConfiguration.audioCapabilities&&C.ksConfiguration.audioCapabilities.length>0&&(b=C.ksConfiguration.audioCapabilities[0]),null===b)throw new Error("Can not create sessions for unknown content types.");var c=b.contentType,d=B.createSession(c,new Uint8Array(a)),e=x(d,a);d.addEventListener(J.error,e),d.addEventListener(J.message,e),d.addEventListener(J.ready,e),d.addEventListener(J.close,e),D.push(e),I("DRM: Session created.  SessionID = "+e.getSessionID()),H.trigger(l.default.KEY_SESSION_CREATED,{data:e})}function q(a,b){var c=a.session;F.isClearKey(A)?c.update(new Uint8Array(b.toJWK())):c.update(new Uint8Array(b))}function r(a){var b=a.session;b.removeEventListener(J.error,a),b.removeEventListener(J.message,a),b.removeEventListener(J.ready,a),b.removeEventListener(J.close,a);for(var c=0;c<D.length;c++)if(D[c]===a){D.splice(c,1);break}b[J.release]()}function s(){}function t(){}function u(){}function v(){return{handleEvent:function(a){switch(a.type){case J.needkey:if(a.initData){var b=ArrayBuffer.isView(a.initData)?a.initData.buffer:a.initData;H.trigger(l.default.NEED_KEY,{key:new g.default(b,"cenc")})}}}}}function w(){var a=null,b=function(){z.removeEventListener("loadedmetadata",a),z[J.setMediaKeys](B),H.trigger(l.default.VIDEO_ELEMENT_SELECTED)};z.readyState>=1?b():(a=b.bind(this),z.addEventListener("loadedmetadata",a))}function x(a,b){return{session:a,initData:b,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(a){switch(a.type){case J.error:H.trigger(l.default.KEY_ERROR,{data:new h.default(this,"KeyError")});break;case J.message:var b=ArrayBuffer.isView(a.message)?a.message.buffer:a.message;H.trigger(l.default.INTERNAL_KEY_MESSAGE,{data:new i.default(this,b,a.destinationURL)});break;case J.ready:I("DRM: Key added."),H.trigger(l.default.KEY_ADDED);break;case J.close:I("DRM: Session closed.  SessionID = "+this.getSessionID()),H.trigger(l.default.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}var y,z,A,B,C,D,E,F,G=this.context,H=a.eventBus,I=a.log,J=a.api;return y={getAllInitData:e,requestKeySystemAccess:m,getKeySystem:d,selectKeySystem:n,setMediaElement:o,createKeySession:p,updateKeySession:q,closeKeySession:r,setServerCertificate:s,loadKeySession:t,removeKeySession:u,reset:c},b(),y}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(11)),g=d(a(29)),h=d(a(23)),i=d(a(24)),j=d(a(27)),k=d(a(26)),l=d(a(5)),m=d(a(3));e.__dashjs_factory_name="ProtectionModel_3Feb2014";var n=m.default.getClassFactory(e);c.default=n},{11:11,23:23,24:24,26:26,27:27,29:29,3:3,5:5}],18:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a,b){var c=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b)));a+="/?";for(var d=0;d<c.kids.length;d++)a+=c.kids[d]+"&";return a=a.substring(0,a.length-1)}function b(){return"GET"}function c(){return"json"}function d(a){if(!a.hasOwnProperty("keys"))return null;for(var b=[],c=0;c<a.keys.length;c++){var d=a.keys[c],e=d.kid.replace(/=/g,""),h=d.k.replace(/=/g,"");b.push(new f.default(e,h))}return new g.default(b)}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(25)),g=d(a(22)),h=d(a(3));e.__dashjs_factory_name="ClearKey";var i=h.default.getSingletonFactory(e);c.default=i},{22:22,25:25,3:3}],19:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(a){return f[a].responseType}function d(a,b){return f[b].getLicenseMessage(a)}function e(a,b){return f[b].getErrorResponse(a)}var f={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(a){return g.default.decodeArray(a.license)},getErrorResponse:function(a){return a}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(a){return a},getErrorResponse:function(a){return String.fromCharCode.apply(null,new Uint8Array(a))}}};return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(3)),g=d(a(1));e.__dashjs_factory_name="DRMToday";var h=f.default.getSingletonFactory(e);c.default=h},{1:1,3:3}],20:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(){return"arraybuffer"}function d(a){return a}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(3));e.__dashjs_factory_name="PlayReady";var g=f.default.getSingletonFactory(e);c.default=g},{3:3}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return a}function b(){return"POST"}function c(){return"arraybuffer"}function d(a){return a}function e(a){return String.fromCharCode.apply(null,new Uint8Array(a))}return{getServerURLFromMessage:a,getHTTPMethod:b,getResponseType:c,getLicenseMessage:d,getErrorResponse:e}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(3));e.__dashjs_factory_name="Widevine";var g=f.default.getSingletonFactory(e);c.default=g},{3:3}],22:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var g=function(){function a(b,c){if(d(this,a),c&&"persistent"!==c&&"temporary"!==c)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=b,this.type=c}return f(a,[{key:"toJWK",value:function(){var a,b=this.keyPairs.length,c={keys:[]};for(a=0;a<b;a++){var d={kty:"oct",alg:"A128KW",kid:this.keyPairs[a].keyID,k:this.keyPairs[a].key};c.keys.push(d)}this.type&&(c.type=this.type);var e=JSON.stringify(c),f=e.length,g=new ArrayBuffer(f),h=new Uint8Array(g);for(a=0;a<f;a++)h[a]=e.charCodeAt(a);return g}}]),a}(),h=g;c.default=h},{}],23:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c){d(this,a),this.sessionToken=b,this.error=c},f=e;c.default=f},{}],24:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c,e,f){d(this,a),this.sessionToken=b,this.message=c,this.defaultURL=e,this.messageType=f||"license-request"},f=e;c.default=f},{}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c){d(this,a),this.keyID=b,this.key=c},f=e;c.default=f},{}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c){d(this,a),this.keySystem=b,this.ksConfiguration=c},f=e;c.default=f},{}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c,e,f,g){d(this,a),this.initDataTypes=["cenc"],this.audioCapabilities=b,this.videoCapabilities=c,this.distinctiveIdentifier=e,this.persistentState=f,this.sessionTypes=g},f=e;c.default=f},{}],28:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c){d(this,a),this.contentType=b,this.robustness=c},f=e;c.default=f},{}],29:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c){d(this,a),this.initData=b,this.initDataType=c},f=e;c.default=f},{}],30:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){k.trigger(g.default.ERROR,{error:"capability",event:a})}function b(a,b,c){k.trigger(g.default.ERROR,{error:"download",event:{id:a,url:b,request:c}})}function c(a,b,c,d){k.trigger(g.default.ERROR,{error:"manifestError",event:{message:a,id:b,manifest:c,event:d}})}function d(a,b,c){k.trigger(g.default.ERROR,{error:"cc",event:{message:a,id:b,cc:c}})}function e(a){k.trigger(g.default.ERROR,{error:"mediasource",event:a})}function h(a){k.trigger(g.default.ERROR,{error:"key_session",event:a})}function i(a){k.trigger(g.default.ERROR,{error:"key_message",event:a})}var j=this.context,k=(0,f.default)(j).getInstance();return{capabilityError:a,downloadError:b,manifestError:c,timedTextError:d,mediaSourceError:e,mediaKeySessionError:h,mediaKeyMessageError:i}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var f=d(a(2)),g=d(a(5)),h=d(a(3)),i="mediasource",j="mediakeys",k="manifest",l="SIDX",m="content",n="initialization",o="xlink",p="codec",q="parse",r="nostreams",s="parse";e.__dashjs_factory_name="ErrorHandler";var t=h.default.getSingletonFactory(e);t.CAPABILITY_ERROR_MEDIASOURCE=i,t.CAPABILITY_ERROR_MEDIAKEYS=j,t.DOWNLOAD_ERROR_ID_MANIFEST=k,t.DOWNLOAD_ERROR_ID_SIDX=l,t.DOWNLOAD_ERROR_ID_CONTENT=m,t.DOWNLOAD_ERROR_ID_INITIALIZATION=n,t.DOWNLOAD_ERROR_ID_XLINK=o,t.MANIFEST_ERROR_ID_CODEC=p,t.MANIFEST_ERROR_ID_PARSE=q,t.MANIFEST_ERROR_ID_NOSTREAMS=r,t.TIMED_TEXT_ERROR_ID_PARSE=s;var u=t;c.default=u},{2:2,3:3,5:5}],31:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var e=function a(b,c,e){d(this,a),this.code=b||null,this.message=c||null,this.data=e||null},f=e;c.default=f},{}]},{},[8])(8)});
//# sourceMappingURL=dash.protection.min.js.map